
---
title: USTC-CS-Courses-Resource
---
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
</head>
    <body>
        <div><h2>
                <a href="../index.html">&nbsp;&nbsp;<i class="fa fa-level-up"></i>&nbsp;&nbsp;</a>:
                /<a href="../../../../index.html"><i class="fa fa-home"></i></a>/<a href="../../../index.html">算法基础</a>/<a href="../../index.html">labs</a>/<a href="../index.html">2018-徐云</a>/<a href="index.html">lab4&sch_2</a>
            </h2>
        <div><span> 根据拼音排序</span></div>
        </div>
        <h2>Directories</h2>
        <ul>
        <li><i class="fa fa-meh-o"></i>&nbsp;None</li>
        </ul>

        <h2>Files</h2>
        <ul>
        <li><a href="https://raw.githubusercontent.com/USTC-Resource/USTC-Course/master/算法基础/labs/2018-徐云/lab4&sch_2/README.md"><i class="fa fa-pencil-square-o"></i>&nbsp;README.md---(4.71K)</a></li>
<li><a href="https://raw.githubusercontent.com/USTC-Resource/USTC-Course/master/算法基础/labs/2018-徐云/lab4&sch_2/schedule.py"><i class="fa fa-file-code-o"></i>&nbsp;schedule.py---(3.29K)</a></li>
<li><a href="https://raw.githubusercontent.com/USTC-Resource/USTC-Course/master/算法基础/labs/2018-徐云/lab4&sch_2/work_dispatch.py"><i class="fa fa-file-code-o"></i>&nbsp;work_dispatch.py---(1.09K)</a></li>
        </ul>

        <div style="text-decration:underline;display:inline">
        <a href="https://github.com/mbinary/USTC-CS-Courses-Resource.git" target="_blank" rel="external"><i class="fa fa-github"></i>&nbsp; Github</a>
        <a href="mailto:&#122;huheqin1@gmail?subject=反馈与建议" style="float:right" target="_blank" rel="external"><i class="fa fa-envelope"></i>&nbsp; Feedback</a>
        </div>

        <h1 style="color:red;text-align:center;">Read Me</h1>

<h2 id="lab1">lab1</h2>
<div class="codehilite"><pre><span></span><span class="c1">#设有n件工作要分配给n个人去完成，将工作i分配给第j个人所需费用为 。试设计一个算法，为每个人分配1件不同的工作，并使总费 用达到最小。</span>

<span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;mat: matrix of c_ij&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">_util</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">arrange</span><span class="p">,</span><span class="n">cost</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; for i-th  work&#39;&#39;&#39;</span>
        <span class="n">nonlocal</span> <span class="n">total</span><span class="p">,</span><span class="n">used</span><span class="p">,</span><span class="n">rst</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="p">:</span>
            <span class="n">total</span><span class="o">=</span><span class="n">cost</span>
            <span class="n">rst</span> <span class="o">=</span> <span class="n">arrange</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># copy is needed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">used</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">and</span><span class="p">(</span> <span class="n">total</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">cost</span><span class="o">+</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;</span><span class="n">total</span><span class="p">):</span>
                    <span class="n">used</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="bp">True</span>
                    <span class="n">arrange</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
                    <span class="n">_util</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">arrange</span><span class="p">,</span><span class="n">cost</span><span class="o">+</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                    <span class="n">used</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
    <span class="n">total</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">rst</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
    <span class="n">used</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">_util</span><span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span><span class="p">,</span><span class="n">rst</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">test_dispatch</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="p">[[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;work matrix: c_ij: work_i and person_j&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;result: &#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dispatch</span><span class="p">(</span><span class="n">mat</span><span class="p">))</span>
<span class="n">test_dispatch</span><span class="p">()</span>    

<span class="sd">&#39;&#39;&#39;result</span>
<span class="sd">work matrix: c_ij: work_i and person_j</span>
<span class="sd">[89, 77, 97, 33, 97, 73, 73, 21, 10, 83]</span>
<span class="sd">[49, 68, 23, 35, 94, 88, 18, 17, 65, 75]</span>
<span class="sd">[38, 76, 68, 13, 94, 22, 19, 49, 35, 71]</span>
<span class="sd">[35, 78, 96, 88, 17, 61, 4, 19, 91, 93]</span>
<span class="sd">[84, 79, 91, 35, 65, 77, 6, 47, 83, 61]</span>
<span class="sd">[57, 14, 33, 100, 1, 100, 42, 83, 94, 51]</span>
<span class="sd">[100, 10, 46, 48, 72, 42, 15, 75, 23, 85]</span>
<span class="sd">[41, 4, 93, 86, 7, 50, 98, 38, 29, 6]</span>
<span class="sd">[7, 51, 59, 69, 65, 48, 27, 69, 91, 23]</span>
<span class="sd">[82, 53, 58, 80, 83, 19, 38, 78, 83, 77]</span>
<span class="sd">result: (114, [8, 2, 3, 7, 6, 4, 1, 9, 0, 5])</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>


<h2 id="lab2">lab2</h2>
<div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">设有n个任务由k个可并行工作的机器来完成，完成任务i需要时间为 。试设计一个算法找出完成这n个任务的最佳调度，使完成全部任务的时间最早。</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">total_ordering</span>
<span class="nd">@total_ordering</span>
<span class="k">class</span> <span class="nc">record</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nums</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nums</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">nums</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">=</span><span class="n">nums</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sum</span><span class="o">+=</span><span class="n">x</span>
    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sum</span><span class="o">-=</span><span class="n">x</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum</span><span class="o">&lt;</span><span class="n">r</span><span class="o">.</span><span class="n">sum</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">r</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum</span><span class="o">==</span><span class="n">r</span><span class="o">.</span><span class="n">sum</span>
    <span class="k">def</span> <span class="nf">tolist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nums</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum</span>
<span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="n">works</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">backtrackSearch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">lsts</span><span class="p">):</span>
        <span class="n">nonlocal</span> <span class="n">best</span><span class="p">,</span><span class="n">rst</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">sum</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">lsts</span> <span class="p">)</span>
            <span class="k">if</span> <span class="n">best</span><span class="o">&gt;</span><span class="n">cost</span><span class="p">:</span>
                <span class="n">best</span><span class="o">=</span> <span class="n">cost</span>
                <span class="n">rst</span> <span class="o">=</span> <span class="p">[</span><span class="n">st</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">lsts</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cur</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">lsts</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">best</span><span class="o">&gt;</span><span class="n">cur</span><span class="o">.</span><span class="n">sum</span><span class="o">+</span><span class="n">works</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">cur</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">works</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">backtrackSearch</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">lsts</span><span class="p">)</span>
                    <span class="n">cur</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">findInitial</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">lst</span><span class="p">):</span>
        <span class="n">nonlocal</span> <span class="n">best</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">best</span><span class="o">&gt;</span><span class="n">cost</span><span class="p">:</span><span class="n">best</span> <span class="o">=</span> <span class="n">cost</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mn</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">visited</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">cur</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">cur</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                    <span class="n">visited</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mn</span><span class="o">&gt;</span><span class="n">cur</span><span class="p">:</span>
                        <span class="n">mn</span> <span class="o">=</span> <span class="n">cur</span>
                        <span class="n">idx</span> <span class="o">=</span> <span class="n">j</span>
            <span class="n">lst</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">+=</span><span class="n">works</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">findInitial</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">lst</span><span class="p">)</span>
            <span class="n">lst</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">-=</span><span class="n">works</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>


    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">works</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;machine Num:&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;works      :&#39;</span><span class="p">,</span><span class="n">works</span><span class="p">)</span>
    <span class="n">rst</span> <span class="o">=</span>  <span class="bp">None</span>
    <span class="n">works</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># key step</span>
    <span class="n">best</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">works</span><span class="p">[:</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">findInitial</span><span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="c1"># key step</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;init  solution: {}    cost time {:.6f}s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">best</span><span class="p">,</span><span class="n">t1</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">backtrackSearch</span><span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="n">record</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;final solution: {}    cost time {:.6f}s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">best</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;schedule  plan:&#39;</span><span class="p">,</span><span class="n">rst</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">best</span><span class="p">,</span><span class="n">rst</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
    <span class="n">schedule</span><span class="p">([</span><span class="mi">47</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">schedule</span><span class="p">([</span><span class="mi">98</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">37</span><span class="p">],</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">schedule</span><span class="p">([</span><span class="mi">39</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">86</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">46</span><span class="p">],</span><span class="mi">8</span><span class="p">)</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">machine Num: 19</span>
<span class="sd">works       : [39, 39, 23, 45, 100, 69, 21, 81, 39, 55, 20, 86, 34, 53, 58, 99, 36, 45, 46]</span>

<span class="sd">works  经过逆序排序</span>
<span class="sd">init  solution: 135    cost time 0.000196s</span>
<span class="sd">final solution: 126    cost time 0.022922s</span>
<span class="sd">schedule  plan: [[100, 21], [99, 23], [86, 39], [81, 45], [69, 53], [58, 45, 20], [55, 36, 34], [46, 39, 39]]</span>

<span class="sd">works 没有经过排序</span>
<span class="sd">init  solution: 168    cost time 0.000179s</span>
<span class="sd">final solution: 126    cost time 10.646307s</span>
<span class="sd">schedule  plan: [[39, 86], [39, 34, 53], [23, 99], [45, 39, 36], [100, 20], [69, 55], [21, 58, 46], [81, 45]]</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
    </body>
